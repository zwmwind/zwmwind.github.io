<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"normal"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="第一章    深入Web请求过程 B&#x2F;S架构的好处 客户端使用统一的浏览器（Browser）">
<meta property="og:type" content="article">
<meta property="og:title" content="读书笔记-深入分析Java Web技术内幕-第一章">
<meta property="og:url" content="http://yoursite.com/2020/08/17/Notes-Book-Analysis-Javaweb-ChapterOne/index.html">
<meta property="og:site_name" content="ZWM&#39;s Blog">
<meta property="og:description" content="第一章    深入Web请求过程 B&#x2F;S架构的好处 客户端使用统一的浏览器（Browser）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2020/08/17/Notes-Book-Analysis-Javaweb-ChapterOne/B-SArchitecture.jpeg">
<meta property="article:published_time" content="2020-08-16T16:09:04.000Z">
<meta property="article:modified_time" content="2021-05-04T14:11:40.452Z">
<meta property="article:author" content="Zhang Weiming">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="书籍">
<meta property="article:tag" content="读书笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/08/17/Notes-Book-Analysis-Javaweb-ChapterOne/B-SArchitecture.jpeg">

<link rel="canonical" href="http://yoursite.com/2020/08/17/Notes-Book-Analysis-Javaweb-ChapterOne/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>读书笔记-深入分析Java Web技术内幕-第一章 | ZWM's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="ZWM's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ZWM's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Record and Thinking</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/17/Notes-Book-Analysis-Javaweb-ChapterOne/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/pikachu.gif">
      <meta itemprop="name" content="Zhang Weiming">
      <meta itemprop="description" content="This is my personal blog!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZWM's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          读书笔记-深入分析Java Web技术内幕-第一章
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-17 00:09:04" itemprop="dateCreated datePublished" datetime="2020-08-17T00:09:04+08:00">2020-08-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-04 22:11:40" itemprop="dateModified" datetime="2021-05-04T22:11:40+08:00">2021-05-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90JavaWeb%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">深入分析JavaWeb技术内幕读书笔记</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="第一章-深入Web请求过程"><a href="#第一章-深入Web请求过程" class="headerlink" title="第一章    深入Web请求过程"></a>第一章    深入Web请求过程</h1><hr>
<h2 id="B-S架构的好处"><a href="#B-S架构的好处" class="headerlink" title="B/S架构的好处"></a>B/S架构的好处</h2><ul>
<li>客户端使用统一的浏览器（Browser）</li>
</ul>
<a id="more"></a>

<ul>
<li>服务端基于统一的HTTP（协议）</li>
</ul>
<p><img src="/2020/08/17/Notes-Book-Analysis-Javaweb-ChapterOne/B-SArchitecture.jpeg" alt="B-SArchitecture.jpeg"></p>
<h2 id="B-S架构概述"><a href="#B-S架构概述" class="headerlink" title="B/S架构概述"></a>B/S架构概述</h2><p>&emsp;&emsp;B/S网络架构从前端到后端都得到了简化，都基于统一的应用层协议HTTP来交互数据，这与大多数传统的C/S互联网应用采用的长连接的交互模式不同，HTTP采用无状态的短连接的通信方式。</p>
<p>&emsp;&emsp;通常情况下，<font color="teal">一次请求就完成了一次数据交互，通常也对应一个业务逻辑，然后这次通信连接就断开了</font>。采用这种方式是为了能够同时服务更多的用户。</p>
<p>&emsp;&emsp;当一个用户在浏览器中输入一个URL时，如<em><a target="_blank" rel="noopener" href="http://www.github.com/">www.github.com</a></em>，将发生很多操作。</p>
<ul>
<li>首先，DNS会把这个域名解析成对应的IP地址</li>
<li>然后，根据这个IP地址在互联网上找到对应的服务器</li>
<li>随后，发起一个请求给服务器</li>
<li>最后，服务器返回默认的数据资源给访问的用户</li>
</ul>
<p>&emsp;&emsp;不管网络结构如何变化，始终有一些固定不变的原则。</p>
<ul>
<li>所有互联网上的资源都要用一个URL来表示，URL就是统一资源定位符。</li>
<li>必须基于HTTP与服务端进行交互。</li>
<li>数据展示必须在浏览器中进行。</li>
</ul>
<h2 id="如何发起一个请求"><a href="#如何发起一个请求" class="headerlink" title="如何发起一个请求"></a>如何发起一个请求</h2><p>&emsp;&emsp;发起一个请求和建议一个Socket连接类似，只不过其outputStream.write写的二进制字节数据格式要符合HTTP。</p>
<ul>
<li>浏览器在建立Socket连接之前，必须根据地址栏中的URL解析（DNS）出相应的的IP地址，在根据地址和端口号与远程服务器建立Socket连接。</li>
<li>浏览器会根据这个URL组成一个get烈性的HTTP请求，通过<font color="red">outputStrem.write</font>发送到目标服务器，服务器等待<font color="teal">inputStream.read</font>返回数据。</li>
<li>最后断开这个连接。</li>
</ul>
<h2 id="HTTP解析"><a href="#HTTP解析" class="headerlink" title="HTTP解析"></a>HTTP解析</h2><p>&emsp;&emsp;B/S网络架构的核心是HTTP，掌握HTTP对一个从事互联网工作的程序员来说非常重要</p>
<p>&emsp;&emsp;要理解HTTP，最重要的就是熟悉HTTP中的HTTP Header，HTTP Header控制着互联网上成千上万的用户数据的传输。最关键的是，它控制着用户<font color="red">浏览器的渲染行为</font>和<font color="teal">服务器的执行逻辑</font>。</p>
<p>&emsp;&emsp;例如，当服务器没有用户请求的数据时就会返回一个404状态码，告诉浏览器没有要请求的数据，通常浏览器就会展示一个该页面不存在的错误信息。</p>
<p>&emsp;&emsp;常见的HTTP请求头和响应头分别如下所示。</p>
<ul>
<li><p>常见的HTTP请求头</p>
<table>
<thead>
<tr>
<th align="center">请求头</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Accept-Charset</td>
<td align="center">用于指定客户端接收的字符集</td>
</tr>
<tr>
<td align="center">Accept-Encoding</td>
<td align="center">用于指定可接受的内容编码：如Accept-Econding:gzip.deflate</td>
</tr>
<tr>
<td align="center">Accept-Language</td>
<td align="center">用于指定一种自然语言，如Accept-Language: zh-cn</td>
</tr>
<tr>
<td align="center">Host</td>
<td align="center">用于指定被请求资源的Internet主机号和端口号，如Host: <em><a target="_blank" rel="noopener" href="http://www.github.com/">www.github.com</a></em></td>
</tr>
<tr>
<td align="center">User-Agent</td>
<td align="center">客户端将它的操作系统、浏览器和其他属性告负服务器</td>
</tr>
<tr>
<td align="center">Connection</td>
<td align="center">当前连接是否保持，如Connetcion:Keep-Alive</td>
</tr>
</tbody></table>
</li>
<li><p>常见的HTTP响应头</p>
<table>
<thead>
<tr>
<th align="center">响应头</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Server</td>
<td align="center">使用的服务器名称，如Server: Apache/1.3.6(Unix)</td>
</tr>
<tr>
<td align="center">Content-Type</td>
<td align="center">用来指明发送给接收者的实体正文的媒体类型，如Content-Type: text/html;charset=GBK</td>
</tr>
<tr>
<td align="center">Content-Encoding</td>
<td align="center">与请求头Accept-Encoding对应，告诉浏览器服务端采用的是什么压缩编码</td>
</tr>
<tr>
<td align="center">Content-Language</td>
<td align="center">描述了资源所用的自然语言，与Accept-Language对应</td>
</tr>
<tr>
<td align="center">Content-Length</td>
<td align="center">指明实体正文的长度，用以字节方式存储的十进制数字来表示</td>
</tr>
<tr>
<td align="center">Keep-Alives</td>
<td align="center">保持连接时间，如Keep-Alive: timeout=5, max=120</td>
</tr>
</tbody></table>
</li>
<li><p>常见的HTTP状态码</p>
<table>
<thead>
<tr>
<th align="center">状态码</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">200</td>
<td align="center">客户端请求成功</td>
</tr>
<tr>
<td align="center">302</td>
<td align="center">临时跳转，跳转的地址通过Location指定</td>
</tr>
<tr>
<td align="center">400</td>
<td align="center">客户端请求有语法错误不能被服务器识别</td>
</tr>
<tr>
<td align="center">403</td>
<td align="center">服务器收到请求，但拒绝提供服务</td>
</tr>
<tr>
<td align="center">404</td>
<td align="center">请求的资源不存在</td>
</tr>
<tr>
<td align="center">500</td>
<td align="center">服务器发生不可预期的错误</td>
</tr>
</tbody></table>
</li>
</ul>
<h3 id="查看HTTP信息的工具"><a href="#查看HTTP信息的工具" class="headerlink" title="查看HTTP信息的工具"></a>查看HTTP信息的工具</h3><ul>
<li>Firebug</li>
<li>HttpFox</li>
<li>其他</li>
</ul>
<h3 id="浏览器缓存机制"><a href="#浏览器缓存机制" class="headerlink" title="浏览器缓存机制"></a>浏览器缓存机制</h3><p>&emsp;&emsp;浏览器缓存是一个比较复杂但又比较重要的的机制</p>
<p>&emsp;&emsp;对浏览器使用刷新之后，会请求服务端返回新的数据，最重要的是会在<font color="red">请求头</font>中增加两个请求项，<font color="teal">Pargma:no-cache</font>和<font color="red">Cache-Control:no-cache</font>。</p>
<ol>
<li>Cache-Control/Pragma（请求头）</li>
</ol>
<ul>
<li><p>这个HTTP Head字段用于指定所有缓存机制在整个请求/响应链中必须服从的指令，而no-cache顾名思义。</p>
<p>HTTP head Pargmma / Cache-Control字段可选的value</p>
<table>
<thead>
<tr>
<th align="center">value</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Public</td>
<td align="center">所有内容都将被缓存，在响应头中设置</td>
</tr>
<tr>
<td align="center">Private</td>
<td align="center">内容只缓存到私有缓存中，在响应头中设置</td>
</tr>
<tr>
<td align="center">no-cache</td>
<td align="center">所有内容都不会被缓存，在请求头和响应头中设置</td>
</tr>
<tr>
<td align="center">no-store</td>
<td align="center">所有内容都不会缓存到缓存或Internet临时文件中，在响应头中设置</td>
</tr>
<tr>
<td align="center">must-revalidation/proxy-revalidation</td>
<td align="center">如果缓存的内容失效，请求必须发送到服务器/代理以进行重新验证，在请求头中设置</td>
</tr>
<tr>
<td align="center">max-age=xxx</td>
<td align="center">缓存的内容将在xxx秒后失效，这个选项只在HTTP1.1中可用，和Last-Modified一起使用时，优先级较高，在响应头中设置</td>
</tr>
</tbody></table>
<ul>
<li>Cache-Control请求字段被各个浏览器支持得较好，优先级较高。</li>
<li>Pragma字段的作用和Cache-Control类似</li>
</ul>
</li>
</ul>
<ol start="2">
<li>Expires（请求头）</li>
</ol>
<p>&emsp;&emsp;Expires通常的使用格式是*<font color="red">Expires: Sat, 25 Feb 2012 12:22:17 GMT</font>*，后面跟着一个日期和时间，超过这个时间后，缓存的内容将失效，也就是浏览器在发出请求之前检查这个页面的字段，看该页面是否已经过期了，过期了就重新向服务器发起请求。</p>
<ol start="3">
<li>Last-Modified/Etag（响应头）</li>
</ol>
<p>&emsp;&emsp;Last-Modified字段一般用于表示一个服务器上的资源的最后修改时间，资源可以是静态（<font color="teal">静态内容自动加上Last-Modified字段</font>）或者动态的内容（<font color="red">如Servlet提供了一个getLastModified方法用于检查某个动态内容是否已经更新</font>），通过这个最后修改时间可以判断当前请求的资源是否是最新的。一般服务器在<font color="yellow">响应头</font>中返回一个Last-Modified字段，告诉浏览器这个页面最后修改时间，如Last-Modified: Sat, 25 Feb 2012 12:55:04 GMT, 浏览器再次请求时会在<font color="red">请求头</font>中增加一个If-Modified-Since: Sat, 25 Feb 2012 12:55:04 GMT字段，询问当前缓存的页面是否时最新的，如果是最新的就返回<font color="teal">304</font>状态码，告诉浏览器是最新的，服务器也不会传输新的数据。</p>
<p>&emsp;&emsp;与<em>Last-Modified</em>字段有类似功能的还有一个Etag字段，这个字段的作用是让服务器给每个页面分配一个唯一的编号，然后通过这个编号来区分当前这个页面是否是最新的。</p>
<h2 id="DNS域名解析"><a href="#DNS域名解析" class="headerlink" title="DNS域名解析"></a>DNS域名解析</h2><p>&emsp;&emsp;在互联网世界中，每个资源都是通过URL来发布和请求资源的，URL中的域名需要解析成IP地址才能与远程主机建立连接，DNS解析就是进行此项工作的。</p>
<h3 id="DNS域名解析过程"><a href="#DNS域名解析过程" class="headerlink" title="DNS域名解析过程"></a>DNS域名解析过程</h3><p>&emsp;&emsp;当一个用户在浏览器中输入<em><a target="_blank" rel="noopener" href="http://www.github.com/">www.github.com</a></em>时，DNS解析大概会进行如下步骤。</p>
<ol>
<li><p>浏览器会检查缓存中有没有这个域名对应的解析过的地址，如果缓存中存在，解析过程结束。</p>
</li>
<li><p>如果缓存中不存在，浏览器会查找系统缓存中是否有这个域名对应的DNS解析结果。（<font color="teal">hosts文件</font>）</p>
</li>
<li><p>在网络配置中，一般都会存在“DNS服务器地址”，这个地址就用于以上两步都不存在缓存的情况。操作系统会将这个域名发送给这里设置的LDNS，也就是本地区的域名服务器，这个DNS通常都提供给你本地互联网接入的一个DNS解析服务。</p>
<p>这个专门的域名解析服务器性能都较好，一般都会缓存域名解析结果，LDNS主要承担了域名解析的工作。</p>
</li>
<li><p>如果LDNS仍然没有命中，就会到Root Server域名服务器请求解析。</p>
</li>
<li><p>Root Server域名服务器返回给本地域名服务器一个所查询域的主域名服务器（GTLD Server）地址。GTLD是国际顶级域名服务器，如.com，.cn，.org等，全球只有13台左右。</p>
</li>
<li><p>本地域名服务器（Local DNS Server）再向上一步返回的GTLD服务器发送请求。</p>
</li>
<li><p>接受请求的GTLD服务器查找并返回此域名对应的Name Server域名服务器的地址，这个Name Server通常就是你注册的域名服务器，例如你在某个域名服务提供商申请的域名，那个这个域名解析任务就由这个域名提供商的服务器完成。</p>
</li>
<li><p>Name Server域名服务器会查询存储的域名和IP的映射关系表，在正常情况下都根据域名得到目标IP记录，连同一个TTL值返回给Local DNS Server域名服务器。</p>
</li>
<li><p>返回该域名对应的IP和TTL值，Local DNS Server会缓存这个域名和IP的对应关系，缓存的时间由TTL值控制。</p>
</li>
<li><p>把解析的结果返回给用户，用户根据TTL值缓存在本地服务器中，域名解析过程结束。</p>
</li>
</ol>
<p>&emsp;&emsp;在实际过程中，可能还有更多步骤，这只是一般情况，如Name Server可能有多级，GTM进行负载均衡设置等。</p>
<h3 id="跟踪域名解析过程"><a href="#跟踪域名解析过程" class="headerlink" title="跟踪域名解析过程"></a>跟踪域名解析过程</h3><p>&emsp;&emsp;在Linux和Windows下都可以使用nslookup命令来查询域名的解析结果。在Linux下还可以使用dig命令来查询DNS的解析过程。</p>
<h3 id="清除缓存的域名"><a href="#清除缓存的域名" class="headerlink" title="清除缓存的域名"></a>清除缓存的域名</h3><p>&emsp;&emsp;DNS域名解析有两个地方缓存解析结果，一个是Local DNS Server，另一个是用户的本地机器，这两个缓存都是TTL值和本地缓存大小控制的。但最大缓存时间是TTL值，基本上Local DNS Server的缓存时间很难人工介入。</p>
<p>&emsp;&emsp;本地缓存可以用如下方式进行清除</p>
<ul>
<li><p>Windows</p>
<p>ipconfig/flushdns</p>
</li>
<li><p>Linux</p>
<p>/etc/init.d/nscd restart</p>
</li>
</ul>
<p>&emsp;&emsp;在Java应用中JVM也会缓存DNS的解析结果，这个缓存由<font color="teal">InetAddress</font>类中完成，其缓存时间比较特殊。其有两种缓存策略。</p>
<ul>
<li><font color="red">正确解析结果缓存</font>    有networkaddress.cache.ttl    默认为-1，永不失效</li>
<li><font color="teal">失败的解析结果缓存</font>    networkaddress.cache.negative.ttl    默认为10，10秒失效</li>
</ul>
<p>&emsp;&emsp;修改这两个值有几种方式</p>
<ul>
<li>直接修改java.security文件中的默认值</li>
<li>在Java的启动参数中增加-Dsun.net.inetaddr.ttl=xxx来设置默认值</li>
<li>通过InetAddress类动态修改</li>
</ul>
<p>&emsp;&emsp;如果需要使用InetAddress类解析域名，必须使用单例模式，不然会有严重的性能问题出现。</p>
<h3 id="几种域名解析方式"><a href="#几种域名解析方式" class="headerlink" title="几种域名解析方式"></a>几种域名解析方式</h3><p>&emsp;&emsp;域名解析记录主要分为以下几种方式</p>
<ul>
<li>A记录，Address，用来指定域名对应的IP地址。A记录可以将多个域名解析到一个IP地址，但不能将一个域名解析到多个IP地址。</li>
<li>MX记录，Mail Exchange，可以将某个域名下的邮件服务器只想自己的Mail Server。如taobao.com的域名的A记录IP地址是155.238.25.xxx，如果将MX记录设置为155.238.25.xxx，即<a href="mailto:&#120;&#x78;&#120;&#x40;&#x74;&#97;&#111;&#98;&#x61;&#111;&#x2e;&#99;&#x6f;&#109;">&#120;&#x78;&#120;&#x40;&#x74;&#97;&#111;&#98;&#x61;&#111;&#x2e;&#99;&#x6f;&#109;</a>的邮件路由，DNS会将邮件发送到155.238.25.xxx所在的服务器，而正常通过Web请求的话<font color="teal">仍然可以解析到A记录的IP地址</font>。</li>
<li>CNAME记录，Canonical Name（别名解析）。其可以为一个域名设置一个或多个别名。</li>
<li>NS记录，为某个域名指定DNS解析服务器。</li>
<li>TXT记录，为某个主机名或域名设置说明。</li>
</ul>
<h2 id="CND工作机制"><a href="#CND工作机制" class="headerlink" title="CND工作机制"></a>CND工作机制</h2><p>&emsp;&emsp;CND，内容分布网络（Content Delivery Network），是构筑在现有Internet上的一种先进的流量分配网络。其目的是通过在现有的Internet中增加一层新的网络架构，使用户可以就近取得所需的内容，提高用户访问网络的想要速度。</p>
<p>&emsp;&emsp;<font color="red">CDN = Mirror + Cache + GSLB。</font>其可以明显提高Internet中信息流动的效率。</p>
<p>&emsp;&emsp;通常来说，CDN以缓存网站中的静态数据为主。CDN一般会达到以下一个目标。</p>
<ul>
<li>可拓展</li>
<li>安全性</li>
<li>可靠性、响应和执行（Reliability、Responsiveness和Performance）。</li>
</ul>
<h3 id="CDN架构"><a href="#CDN架构" class="headerlink" title="CDN架构"></a>CDN架构</h3><p>&emsp;&emsp;一个用户访问某个静态文件，域名为cdn.taobao.com。</p>
<ul>
<li>首先向Local DNS服务器发起请求</li>
<li>经过迭代解析后回到域名的注册服务器解析</li>
<li>指向CDN全局中的DNS负载均衡服务器</li>
<li>GTM最终返回里这个访问用户最”近”的节点</li>
<li>用户去CND拿到静态文件</li>
</ul>
<h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>&emsp;&emsp;负载均衡（Load Balance）就是对工作任务进行平衡、分摊到多个操作单元上执行，共同完成任务。其可以<font color="teal">提高服务器响应速度以及利用效率，避免软件或者硬件模块出现单点失效，解决网络拥塞问题，实现地理位置无关性，为用户提供较为一致的访问质量</font>。</p>
<p>&emsp;&emsp;通常有三种负载均衡架构：</p>
<ul>
<li>链路负载均衡：通过DNS解析成不同的IP，用户根据IP来访问不同的目标服务器</li>
<li>集群负载均衡：<ul>
<li>硬件负载均衡：使用一台专门的硬件设备来转发请求</li>
<li>软件负载均衡：1. 在网络层利用IP地址进行地址转发。2. 根据访问用户的HTTP请求头来进行负载均衡</li>
</ul>
</li>
<li>操作系统负载均衡：利用操作系统级别的软中断或者硬件中断来达到负载均衡，如可以设置多队列网卡灯。</li>
</ul>
<p>&emsp;&emsp;CND、Web服务或者分布式数据集群中都可以使用，后两种较为常见。</p>
<h3 id="CND动态加速"><a href="#CND动态加速" class="headerlink" title="CND动态加速"></a>CND动态加速</h3><p>&emsp;&emsp;CDN动态加速的技术原理是在CDN的DNS解析中通过动态的链路探测来寻找回源最好的一条路径，然后通过DNS的调度将所有请求调度到选定的这条路径上回源，从而加速用户的访问效率。</p>
<p>&emsp;&emsp;由于CDN节点遍布全球，所以当用户接入一个CDN节点后，可以选择一条从离用户最近的CND节点到源站链路最好的路径进行数据传输。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ul>
<li>B/S结构</li>
<li>如何发起一个请求</li>
<li>HTTP解析</li>
<li>DNS域名解析</li>
<li>CDN工作机制</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li>《深入分析Java Web技术内幕》，许令波.</li>
</ul>

    </div>

    
    
    
        <div class="reward-container">
  <div>End, thanks</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Zhang Weiming 支付宝">
        <p>支付宝</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Zhang Weiming 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 笔记</a>
              <a href="/tags/%E4%B9%A6%E7%B1%8D/" rel="tag"><i class="fa fa-tag"></i> 书籍</a>
              <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 读书笔记</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/10/hello-world/" rel="prev" title="Hello-World">
      <i class="fa fa-chevron-left"></i> Hello-World
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/20/Notes-Book-Analysis-Javaweb-ChapterTwo/" rel="next" title="读书笔记-深入分析Java Web技术内幕-第二章">
      读书笔记-深入分析Java Web技术内幕-第二章 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E6%B7%B1%E5%85%A5Web%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">第一章    深入Web请求过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#B-S%E6%9E%B6%E6%9E%84%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="nav-number">1.1.</span> <span class="nav-text">B&#x2F;S架构的好处</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-S%E6%9E%B6%E6%9E%84%E6%A6%82%E8%BF%B0"><span class="nav-number">1.2.</span> <span class="nav-text">B&#x2F;S架构概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%8F%91%E8%B5%B7%E4%B8%80%E4%B8%AA%E8%AF%B7%E6%B1%82"><span class="nav-number">1.3.</span> <span class="nav-text">如何发起一个请求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP%E8%A7%A3%E6%9E%90"><span class="nav-number">1.4.</span> <span class="nav-text">HTTP解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BHTTP%E4%BF%A1%E6%81%AF%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="nav-number">1.4.1.</span> <span class="nav-text">查看HTTP信息的工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6"><span class="nav-number">1.4.2.</span> <span class="nav-text">浏览器缓存机制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DNS%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="nav-number">1.5.</span> <span class="nav-text">DNS域名解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="nav-number">1.5.1.</span> <span class="nav-text">DNS域名解析过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%9F%E8%B8%AA%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="nav-number">1.5.2.</span> <span class="nav-text">跟踪域名解析过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E9%99%A4%E7%BC%93%E5%AD%98%E7%9A%84%E5%9F%9F%E5%90%8D"><span class="nav-number">1.5.3.</span> <span class="nav-text">清除缓存的域名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%A0%E7%A7%8D%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E6%96%B9%E5%BC%8F"><span class="nav-number">1.5.4.</span> <span class="nav-text">几种域名解析方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CND%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6"><span class="nav-number">1.6.</span> <span class="nav-text">CND工作机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CDN%E6%9E%B6%E6%9E%84"><span class="nav-number">1.6.1.</span> <span class="nav-text">CDN架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="nav-number">1.6.2.</span> <span class="nav-text">负载均衡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CND%E5%8A%A8%E6%80%81%E5%8A%A0%E9%80%9F"><span class="nav-number">1.6.3.</span> <span class="nav-text">CND动态加速</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">1.7.</span> <span class="nav-text">小结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">1.8.</span> <span class="nav-text">参考资料</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zhang Weiming"
      src="/images/pikachu.gif">
  <p class="site-author-name" itemprop="name">Zhang Weiming</p>
  <div class="site-description" itemprop="description">This is my personal blog!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zwmwind" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zwmwind" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhangweiming1995@qq.com" title="E-Mail → mailto:zhangweiming1995@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 
    src="//music.163.com/outchain/player?type=2&id=402070513&auto=0&height=66"></iframe>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Weiming</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">31k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">28 分钟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
